<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="The MIDI files database specifically suitable for Synthesia use">
        <meta name="author" content="Noxalus">

        <title>Piamidi - {% block title %}{% endblock %}</title>

        <link rel="stylesheet" href="{{ asset('css/global.css') }}" />
        <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}" />
        <link rel="stylesheet" href="{{ asset('css/bootstrap-social.css') }}" />
        <link rel="stylesheet" href="{{ asset('css/font-awesome.min.css') }}" />
        <link rel="stylesheet" href="{{ asset('css/cover.css') }}" />
        {% block stylesheets %}{% endblock %}

        <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>
    <body>

        <div class="site-wrapper">
            <div class="site-wrapper-inner sm-wrapper-inner">
                {% include 'default/header.html.twig' %}
                <div>
                    {% for label, flashes in app.session.flashbag.all %}
                        {% for flash in flashes %}
                            <div class="alert alert-{{ label }}">
                                <button type="button" class="close" data-dismiss="alert">&times;</button>
                                {{ flash }}
                            </div>
                        {% endfor %}
                    {% endfor %}
                    {% block content %}{% endblock %}
                </div>
                {% include 'default/footer.html.twig' %}
            </div>
        </div>

        <!-- Modal -->
        {% include 'modal/login_modal.html.twig' %}
        {% include 'modal/register_modal.html.twig' %}

        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="{{ asset('js/jquery.min.js') }}"></script>
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="{{ asset('js/bootstrap.min.js') }}"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="{{ asset('js/ie10-viewport-bug-workaround.js') }}"></script>

        <script>
            $(document).ready(function(){
                $('#_login_submit').click(function(e){
                    e.preventDefault();
                    $('.error').html('');
                    $.ajax({
                        type        : $('form').attr( 'method' ),
                        url         : '{{ path("fos_user_security_check") }}',
                        data        : $('form').serialize(),
                        dataType    : "json",
                        success     : function(data, status, object) {
                            if(data.error) 
                                $('.error').html(data.message);
                            else
                                location.reload();
                        },
                        error: function(data, status, object){
                            console.log(data.message);
                        }
                    });
                });
            });
        </script>

        <!-- Google Analytics -->
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-68243124-1', 'auto');
          ga('send', 'pageview');

        </script>

        {% block javascripts %}{% endblock %}
    </body>
</html>
